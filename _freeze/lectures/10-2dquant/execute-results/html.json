{
  "hash": "84e5800ccdbfc50cfd404d35f5f74052",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"2D Quantitative Data: Scatterplots and Linear Regression\"\nauthor: \"Prof Ron Yurko\"\nfooter:  \"[statds-36315-spring25](https://ryurko.github.io/statds-36315-spring25/)\"\ndate: 2025-02-17\nengine: knitr\nformat:\n  revealjs:\n    theme: theme.scss\n    chalkboard: true\n    pdf-separate-fragments: true\n    slide-number: c/t\n    smaller: true\n    code-line-numbers: true\n    linestretch: 1.25\n    html-math-method:\n      method: mathjax\n      url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\n---\n\n\n\n\n\n\n## Announcements, previously, and today...\n\n::: {style=\"font-size: 60%;\"}\n\n**HW4 is due Wednesday by 11:59 PM and you have Lab 6 again on Friday!**\n\n**Take-home exam is next week Wednesday Feb 26th**\n\nHere's how the exam will work:\n\n+ I'll post the exam Monday evening, and it's due Wednesday by 11:59 PM EDT (Feb 26th)\n  \n+ Exam will cover material from HW 1-4 and Labs 1-6\n  \n+ Questions will be similar to homeworks but more open-ended, e.g, instead of \"make a side-by-side violin plot...\" I'll ask \"Make a plot that compares the conditional distributions...\"\n  \n+ __There will NOT be class on Wednesday Feb 26th__ \n  \n+ Conflict Feb 26th? __Let me know ASAP!__ Day-of accommodations will NOT be made, late submissions will NOT be accepted\n\n:::\n\n. . .\n\n::: {style=\"font-size: 60%;\"}\n\n\nDiscussed power in the context of visualizations and statistical tests\n\nEven if there is a true effect, you may have limited power to detect it\n\nSeveral ways to formally compare distributions:\n\n* $t$-test: Compare means\n\n* Bartlett's test: Compare variances\n\n* KS test: Compare distributions\n\n\n:::\n\n. . .\n\n::: {style=\"font-size: 80%;\"}\n\n**TODAY:** 2D quantitative data, scatterplots, and linear regression\n\n:::\n\n---\n\n## 2D quantitative data\n\n- We're working with two variables: $(X, Y) \\in \\mathbb{R}^2$, i.e., dataset with $n$ rows and 2 columns\n\n. . .\n\n- Goals:\n\n  - describing the relationships between two variables\n  \n  - describing the conditional distribution $Y | X$ via regression analysis\n  \n  - describing the joint distribution $X,Y$ via contours, heatmaps, etc.\n  \n. . .\n\n- Few big picture ideas to keep in mind:\n\n  - scatterplots are by far the most common visual\n  \n  - regression analysis is by far the most popular analysis (you have a whole class on this...)\n  \n  - relationships may vary across other variables, e.g., categorical variables\n  \n---\n\n## Making scatterplots with `geom_point()`\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"2-3\"}\npenguins |>\n  ggplot(aes(x = flipper_length_mm, y = body_mass_g)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n## ALWAYS adjust the `alpha`\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\npenguins |>\n  ggplot(aes(x = flipper_length_mm, y = body_mass_g)) +\n  geom_point(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-3-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Map categorical variable to `color`\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\npenguins |>\n  ggplot(aes(x = flipper_length_mm, y = body_mass_g,\n             color = species)) +\n  geom_point(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Map continuous variable to `color`\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\npenguins |>\n  ggplot(aes(x = flipper_length_mm, y = body_mass_g,\n             color = body_mass_g)) +\n  geom_point(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-5-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Map continuous variable to `color`\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"5\"}\npenguins |>\n  ggplot(aes(x = flipper_length_mm, y = body_mass_g,\n             color = body_mass_g)) +\n  geom_point(alpha = 0.5) +\n  scale_color_gradient(low = \"darkblue\", high = \"darkorange\")\n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-6-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Map continuous variable to `size`\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\npenguins |>\n  ggplot(aes(x = flipper_length_mm, y = body_mass_g,\n             size = body_mass_g)) +\n  geom_point(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-7-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Map categorical variable to `shape`\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\npenguins |>\n  ggplot(aes(x = flipper_length_mm, y = body_mass_g,\n             shape = species)) +\n  geom_point(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-8-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## ALL AT ONCE!\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npenguins |>\n  ggplot(aes(x = bill_depth_mm, y = bill_length_mm,\n             color = species, shape = island, size = body_mass_g)) +\n  geom_point(alpha = 0.5) \n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-9-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n![](https://images.squarespace-cdn.com/content/v1/5ce45e9df03bfe000172d138/1597870238202-3OWP5306LOI8P2HP02EN/Jeff+Goldblum+Your+Scientists+Were+so+preoccupied+with+whether+or+not+they+could+they+didn%27t+stop+to+think+if+they+should.jpg){fig-align=\"center\"}\n\n\n---\n\n## Displaying trend lines: linear regression\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\npenguins |>\n  ggplot(aes(x = flipper_length_mm, y = body_mass_g)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-10-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n## Setup and motivation for linear regression\n\n\n::: {style=\"font-size: 85%;\"}\n\nConsider an outcome $Y \\in \\mathbb{R}$ and covariate $X \\in \\mathbb{R}$\n\n  + We have $n$ observations: $(X_1, Y_1), \\dots, (X_n, Y_n)$\n  \nPurpose of regression is to model $\\mathbb{E}[Y | X]$\n\nConsider the case where $X$ takes on discrete values $c_1, \\dots, c_k$\n\nThen most straightforward way to estimate $\\mathbb{E}[Y | X = c_j]$ is to use the sample mean for subgroup $X_i = c_j$:\n\n$$\\hat{\\mathbb{E}}[Y|X = c_j] = \\frac{1}{N_j} \\sum_{i: X_i = c_j} Y_i$$\n\n+ Graphs like side-by-side violin plots, facetted histograms, and overlaid density plots essentially compare $\\hat{\\mathbb{E}}[Y|X = c_j]$ for different categories\n\nBut when $X$ is quantitative, what do we do?\n\n+ Use statistical model to \"guess\" $\\mathbb{E}[Y|X = x]$, even when we don't observe $X = x$\n\n:::\n\n---\n\n## Statistical Model for Linear Regression\n\nLinear regression assumes $Y_i \\overset{iid}{\\sim} N(\\beta_0 + \\beta_1 X_i, \\sigma^2)$\n\n- $\\beta_0$: _intercept_ - population mean outcome when $X = 0$; i.e., $\\mathbb{E}[Y | X = 0]$\n\n- $\\beta_1$: _slope_ - population mean _change_ in $Y$ when $X$ increases by 1\n\n- $\\beta_0$ and $\\beta_1$ are parameters that must be estimated\n\n<!--\n\nThe assumptions baked into this model are:\n\n1. Normality\n\n2. Equal variance\n\n3. Independent errors\n\n4. Linearity\n\n5. Fixed $X$\n\n-->\n\n---\n\n## Assessing assumptions of linear regression\n\nLinear regression assumes $Y_i \\overset{iid}{\\sim} N(\\beta_0 + \\beta_1 X_i, \\sigma^2)$\n\n- If this is true, then $Y_i - \\hat{Y}_i \\overset{iid}{\\sim} N(0, \\sigma^2)$\n\n. . .\n\nPlot residuals against $\\hat{Y}_i$, __residuals vs fit__ plot\n\n- Used to assess linearity, any divergence from mean 0\n\n- Used to assess equal variance, i.e., if $\\sigma^2$ is homogenous across predictions/fits $\\hat{Y}_i$\n\n. . .\n\nMore difficult to assess the independence and fixed $X$ assumptions\n\n- Make these assumptions based on subject-matter knowledge\n\n---\n\n## Residual vs fit plots\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlin_reg <- lm(body_mass_g ~ flipper_length_mm, data = penguins)\n\ntibble(fits = fitted(lin_reg), residuals = residuals(lin_reg)) |>\n  ggplot(aes(x = fits, y = residuals)) +\n  geom_point(alpha = 0.5) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\")\n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-11-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n## Residual vs fit plots\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"5\"}\ntibble(fits = fitted(lin_reg), residuals = residuals(lin_reg)) |>\n  ggplot(aes(x = fits, y = residuals)) +\n  geom_point(alpha = 0.5) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +\n  geom_smooth()\n```\n\n::: {.cell-output-display}\n![](10-2dquant_files/figure-revealjs/unnamed-chunk-12-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Examples of Residual-vs-Fit Plots\n\n\n\n\n---\n\n## Recap and next steps\n\n::: {style=\"font-size: 80%;\"}\n\nScatterplots are the most common visual for 2D quantitative variables\n\n+ Many ways to incorporate additional dimensions in scatterplots, e.g., color and shape\n\nLinear regression is by far the most common model for describing the relationship between 2+ quantitative variables\n\n+ Can also: transform the outcome, transform the covariates, do nonparametric \"smoothing\"\n\nUse graphs to assess linear regression assumptions, i.e., residual diagnostic plots\n\n:::\n\n. . .\n\n::: {style=\"font-size: 80%;\"}\n\n+ **HW4 due Wednesday and you have Lab 6 on Friday**\n\n+ **Graphics critique due Feb 28th!**\n\n+ **Next time**: Inference with Linear Regression\n\n+ Recommended reading: [CW Chapter 12 Visualizing associations among two or more quantitative variables](https://clauswilke.com/dataviz/visualizing-associations.html)\n\n:::\n\n",
    "supporting": [
      "10-2dquant_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}