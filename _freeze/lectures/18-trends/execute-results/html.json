{
  "hash": "fb2ea5c870989c22358e68270eb11acb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Visualizing Trends\"\nauthor: \"Prof Ron Yurko\"\nfooter:  \"[statds-36315-spring25](https://ryurko.github.io/statds-36315-spring25/)\"\ndate: 2025-03-26\nengine: knitr\nformat:\n  revealjs:\n    theme: theme.scss\n    chalkboard: true\n    pdf-separate-fragments: true\n    slide-number: c/t\n    smaller: true\n    code-line-numbers: true\n    linestretch: 1.25\n    html-math-method:\n      method: mathjax\n      url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\n---\n\n\n\n\n\n\n## Announcements, previously, and today...\n\n::: {style=\"font-size: 75%;\"}\n\n**HW6 is due Wednesday March 26th by 11:59 PM ET**\n\n**You have Lab 8 this Friday**\n\n**We do NOT have in-class lecture on Wednesday! I will post a recording**\n\n:::\n\n. . .\n\n::: {style=\"font-size: 75%;\"}\n\nCommon workflow:\n\n+ Reduce the data to a few \"useful\" dimensions\n\n+ Plot those \"useful\" dimensions\n\n\nLast two classes:\n\n1. Reduce the data by summarizing pairs of subjects with one distance.\n\n2. Visualize distances using multi-dimensional scaling or dendrograms.\n\nHow can we reduce the data without distances?\n\n**Principal Component Analysis (PCA) is by far the most popular way**\n\n:::\n\n---\n\n## Longitudinal data and time series structure\n\n- Consider a _single observation_ measured across time\n\n| Variable   | $T_1$   | $T_2$   | $\\dots$  | $T_J$ |\n| ---------- | -------- | -------- | -------- | -------- |\n| $X_1$ | $x_{11}$ | $x_{12}$ | $\\dots$  | $x_{1J}$ |\n| $X_2$ | $x_{21}$ | $x_{22}$ | $\\dots$  | $x_{2J}$ |\n| $\\vdots$    | $\\vdots$  | $\\vdots$  | $\\dots$  | $\\vdots$  |\n| $X_P$ | $x_{P1}$ | $x_{P2}$ | $\\dots$  | $x_{PJ}$ |\n\n\n- With $N$ observations we have $N$ of these matrices\n\n- Time may consist of regularly spaced intervals\n\n  - For example, $T_1 = t$, $T_2 = t + h$, $T_3 = t + 2h$, etc.\n  \n- Irregularly spaced intervals, then work with the raw $T_1,T_2,...$\n\n\n---\n\n## Example: Statistics PhDs by year\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nstat_phd_year_summary |>\n  ggplot(aes(x = year, y = n_phds)) +\n  geom_point() +\n  theme_light() +\n  labs(x = \"Year\", y = \"Number of PhDs\", title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n## Example: Statistics PhDs by year\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"4-5\"}\nstat_phd_year_summary |>\n  ggplot(aes(x = year, y = n_phds)) +\n  geom_point() +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year), \n                     labels = unique(stat_phd_year_summary$year)) + \n  theme_light() +\n  labs(x = \"Year\", y = \"Number of PhDs\", title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-3-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Add lines to emphasize order\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\nstat_phd_year_summary |>\n  ggplot(aes(x = year, y = n_phds)) +\n  geom_point() +\n  geom_line() +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year)) +\n  theme_light() +\n  labs(x = \"Year\", y = \"Number of PhDs\",\n       title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n## Drop points to emphasize trends\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nstat_phd_year_summary |>\n  ggplot(aes(x = year, y = n_phds)) +\n  geom_line() +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year)) +\n  theme_light() +\n  labs(x = \"Year\", y = \"Number of PhDs\",\n       title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-5-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Can fill the area under the line\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nstat_phd_year_summary |>\n  ggplot(aes(x = year, y = n_phds)) +\n  geom_area(fill = \"darkblue\", alpha = 0.5) +\n  geom_line() +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year)) +\n  theme_light() +\n  labs(x = \"Year\", y = \"Number of PhDs\",\n       title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-6-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n## Several time series? Do NOT only use points\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\nstats_phds |>\n  ggplot(aes(x = year, y = n_phds, color = field)) +\n  geom_point() +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year)) +\n  theme_light() +\n  theme(legend.position = \"bottom\", legend.text = element_text(size = 7)) +\n  labs(x = \"Year\", y = \"Number of PhDs\",\n       title = \"Number of Statistics-related PhDs awarded over time\",\n       color = \"Field\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-7-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n## Several time series? Use lines!\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\nstats_phds |>\n  ggplot(aes(x = year, y = n_phds, color = field)) +\n  geom_line() +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year)) +\n  theme_light() +\n  theme(legend.position = \"bottom\") +\n  labs(x = \"Year\", y = \"Number of PhDs\", color = \"Field\",\n       title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-8-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Using [`ggrepel`](https://ggrepel.slowkow.com/articles/examples.html) to directly label lines\n\n\n\n\n::: {.cell layout-align=\"center\" output-location='slide'}\n\n```{.r .cell-code}\nstats_phds_2017 <- stats_phds |> filter(year == 2017)\n\nlibrary(ggrepel)\nstats_phds |>\n  ggplot(aes(x = year, y = n_phds, color = field)) +\n  geom_line() +\n  # Add the labels:\n  geom_text_repel(data = stats_phds_2017, aes(label = field),\n                  size = 3, \n                  # Drop the segment connection:\n                  segment.color = NA, \n                  # Move labels up or down based on overlap\n                  direction = \"y\",\n                  # Try to align the labels horizontally on the left hand side\n                  hjust = \"left\") +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year),\n                     # Update the limits so that there is some padding on the\n                     # x-axis but don't label the new maximum\n                     limits = c(min(stat_phd_year_summary$year),\n                                max(stat_phd_year_summary$year) + 3)) +\n  theme_light() +\n  theme(legend.position = \"none\") +\n  labs(x = \"Year\", y = \"Number of PhDs\", color = \"Field\",\n       title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-9-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Using [`gghighlight`](https://yutannihilation.github.io/gghighlight/articles/gghighlight.html) instead\n\n\n\n\n::: {.cell layout-align=\"center\" output-location='slide'}\n\n```{.r .cell-code  code-line-numbers=\"1,5\"}\nlibrary(gghighlight)\nstats_phds |>\n  ggplot(aes(x = year, y = n_phds, color = field)) +\n  geom_line() +\n  gghighlight()  +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year)) +\n  theme_light() +\n  theme(legend.position = \"none\") +\n  labs(x = \"Year\", y = \"Number of PhDs\", color = \"Field\",\n       title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-10-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Using [`gghighlight`](https://yutannihilation.github.io/gghighlight/articles/gghighlight.html) instead\n\n\n\n\n\n::: {.cell layout-align=\"center\" output-location='slide'}\n\n```{.r .cell-code  code-line-numbers=\"1,5\"}\nlibrary(gghighlight)\nstats_phds |>\n  ggplot(aes(x = year, y = n_phds, color = field)) +\n  geom_line() +\n  gghighlight(line_label_type = \"sec_axis\")  +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year)) +\n  theme_light() +\n  theme(legend.position = \"none\") +\n  labs(x = \"Year\", y = \"Number of PhDs\", color = \"Field\",\n       title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-11-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n## How do we plot many lines? NOT LIKE THIS!\n\n\n\n\n::: {.cell layout-align=\"center\" output-location='slide'}\n\n```{.r .cell-code  code-line-numbers=\"1\"}\nphd_field |>\n  ggplot(aes(x = year, y = n_phds, color = field)) +\n  geom_line() +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year)) +\n  theme_light() +\n  theme(legend.position = \"none\") +\n  labs(x = \"Year\", y = \"Number of PhDs\", color = \"Field\",\n       title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-12-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## Instead we highlight specific lines\n\n\n\n\n::: {.cell layout-align=\"center\" output-location='slide'}\n\n```{.r .cell-code}\nphd_field |>\n  filter(!(field %in% c(\"Biometrics and biostatistics\", \"Statistics (mathematics)\"))) |>\n  ggplot() +\n  # Add the background lines - need to specify the group to be the field\n  geom_line(aes(x = year, y = n_phds, group = field),\n            color = \"gray\", size = .5, alpha = .5) +\n  # Now add the layer with the lines of interest:\n  geom_line(data = filter(phd_field,\n                          # Note this is just the opposite of the above since ! is removed\n                          field %in% c(\"Biometrics and biostatistics\", \n                                       \"Statistics (mathematics)\")),\n            aes(x = year, y = n_phds, color = field),\n            # Make the size larger\n            size = .75, alpha = 1) +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year)) +\n  theme_light() +\n  theme(legend.position = \"bottom\", \n        # Drop the panel lines making the gray difficult to see\n        panel.grid = element_blank()) +\n  labs(x = \"Year\", y = \"Number of PhDs\", color = \"Field\",\n       title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-13-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n## Or you can use [`gghighlight`](https://yutannihilation.github.io/gghighlight/articles/gghighlight.html) instead\n\n\n\n\n\n::: {.cell layout-align=\"center\" output-location='slide'}\n\n```{.r .cell-code  code-line-numbers=\"4-5\"}\nphd_field |>\n  ggplot(aes(x = year, y = n_phds, color = field)) +\n  geom_line() +\n  gghighlight(field %in% c(\"Biometrics and biostatistics\", \"Statistics (mathematics)\"),\n              line_label_type = \"sec_axis\") +\n  scale_x_continuous(breaks = unique(stat_phd_year_summary$year),\n                     labels = unique(stat_phd_year_summary$year)) +\n  theme_light() +\n  theme(legend.position = \"none\") +\n  labs(x = \"Year\", y = \"Number of PhDs\", color = \"Field\",\n       title = \"Number of Statistics-related PhDs awarded over time\")\n```\n\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-14-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n---\n\n## What about Nightingale's rose diagram?\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](https://daily.jstor.org/wp-content/uploads/2020/08/florence_nightingagle_data_visualization_visionary_1050x700.jpg){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n---\n\n## What about Nightingale's rose diagram?\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-16-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n## What about displaying lines instead?\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](18-trends_files/figure-revealjs/unnamed-chunk-17-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n---\n\n## Recap and next steps\n\n+ Discussed various aspects of visualizing trends\n\n+ When visualizing many lines, often useful to consider highlighting a small subset\n\n. . .\n\n+ **HW6 is due TONIGHT and you have lab on Friday!**\n\n+ **I will not have office hours today**\n\n. . .\n\n+ **Next time**: Time series, autocorrelation, and seasonal decomposition\n\n+ Recommended reading: [CW CH 13 Visualizing time series and other functions of an independent variable](https://clauswilke.com/dataviz/time-series.html), [CW CH 14 Visualizing trends](https://clauswilke.com/dataviz/visualizing-trends.html)\n",
    "supporting": [
      "18-trends_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}